*&---------------------------------------------------------------------*
*&  Include           ZR_PP_ROUTING_VAR_DD
*&---------------------------------------------------------------------*

DATA : FROM_DATE LIKE SY-DATUM , TO_DATE LIKE AFRU-BUDAT.

TABLES : MARA , MAKT,AFRU,AFKO.


type-pools: slis.
data :t_fieldcat  type slis_t_fieldcat_alv,
      w_fieldcat  type slis_fieldcat_alv,
      layout      type slis_layout_alv,
      t_sort      type slis_t_sortinfo_alv,
      t_event     type slis_t_event with header line,
      d_repid     like sy-repid,
      d_layout    type slis_layout_alv,
      key         type slis_keyinfo_alv.

*TYPES : BEGIN OF GS ,
*        ORDERNO TYPE AUFNR ,
*         WCENTER TYPE  KTEXT,
*        WCENTER_CODE TYPE ARBPL ,
*         MAT TYPE MATNR,
*        DESCRIPTION TYPE   MAKTX ,
**        ORDER_QTY TYPE  GAMNG,
*        ORDER_QTY TYPE  p DECIMALS 0,
*        UOM  TYPE CO_ISMNGEH ,
**        CONF_QTY TYPE GMNGA ,
*        CONF_QTY TYPE P DECIMALS 0 ,
*
**         CONF_ACTV2 like AFRU-ISM02 ,
*         CONF_ACTV2  TYPE P  DECIMALS 2 ,
**         STD_VALUE2 LIKE AFVV-VGW02 ,
*         STD_VALUE2  TYPE P  DECIMALS 2 ,
*
**        STANDARD_M LIKE  AFVV-ISM02 ,
**        STANDARD_M(16) TYPE P  DECIMALS 0,
*        STANDARD_M(16) TYPE p DECIMALS 2,
**        STANDARD_M TYPE I ,
**        VAR_M  LIKE AFVV-ISM02 ,
*        VAR_M(16) TYPE P  DECIMALS 2,
**        VAR_M_PERC LIKE AFVV-ISM02,
**        VAR_M_PERC  TYPE  p DECIMALS 2  ,
*        VAR_M_PERC  TYPE P DECIMALS 2 ,
**        VAR_M_PERC  TYPE p DECIMALS 2  ,
**        VAR_M_PERC0(15)  TYPE C  ,
*
**         CONF_ACTV3 like AFRU-ISM03 ,
*         CONF_ACTV3(16) TYPE P  DECIMALS 2,
**         STD_VALUE3 like AFVV-VGW03 ,
*         STD_VALUE3(16) TYPE P  DECIMALS 2,
*
*
**        STANDARD_L LIKE  AFVV-ISM02 ,
*        STANDARD_L(16) TYPE p DECIMALS 2,
**        VAR_L  LIKE AFVV-ISM02 ,
*        VAR_L(16) TYPE P  DECIMALS 2,
*        VAR_L_PERC(5) TYPE C ,
**         VAR_L_PERC0(15) TYPE  C  ,
*        "unit of measure
*         ILE02 LIKE AFRU-ILE02,
*         ILE03 LIKE AFRU-ILE03,
*         VGE02 LIKE AFVV-VGE02,
*         VGE03 LIKE AFVV-VGE03,
*
*       END OF GS.
TYPES : BEGIN OF GS ,
        ORDERNO TYPE AUFNR ,
         WCENTER TYPE  KTEXT,
        WCENTER_CODE TYPE ARBPL ,
         MAT TYPE MATNR,
        DESCRIPTION TYPE   MAKTX ,
*        ORDER_QTY TYPE  GAMNG,
        ORDER_QTY TYPE  p DECIMALS 0,
        UOM  TYPE CO_ISMNGEH ,
*        CONF_QTY TYPE GMNGA ,
        CONF_QTY TYPE P DECIMALS 0 ,

*         CONF_ACTV2 like AFRU-ISM02 ,
         CONF_ACTV2  TYPE P  DECIMALS 2 ,
*         STD_VALUE2 LIKE AFVV-VGW02 ,
         STD_VALUE2  TYPE P  DECIMALS 2 ,

*        STANDARD_M LIKE  AFVV-ISM02 ,
*        STANDARD_M(16) TYPE P  DECIMALS 0,
        STANDARD_M(16) TYPE p DECIMALS 2,
*        STANDARD_M TYPE I ,
*        VAR_M  LIKE AFVV-ISM02 ,
        VAR_M(16) TYPE P  DECIMALS 2,
*        VAR_M_PERC LIKE AFVV-ISM02,
*        VAR_M_PERC  TYPE p DECIMALS 2  ,
        VAR_M_PERC(15)  TYPE p DECIMALS 2  ,
        VAR_M_PERC0(15)  TYPE C  ,

*         CONF_ACTV3 like AFRU-ISM03 ,
         CONF_ACTV3(16) TYPE P  DECIMALS 2,
*         STD_VALUE3 like AFVV-VGW03 ,
         STD_VALUE3(16) TYPE P  DECIMALS 2,


*        STANDARD_L LIKE  AFVV-ISM02 ,
        STANDARD_L(16) TYPE p DECIMALS 2,
*        VAR_L  LIKE AFVV-ISM02 ,
        VAR_L(16) TYPE P  DECIMALS 2,
        VAR_L_PERC TYPE  p DECIMALS 2 ,
         VAR_L_PERC0(15) TYPE  C  ,
        "unit of measure
         ILE02 LIKE AFRU-ILE02,
         ILE03 LIKE AFRU-ILE03,
         VGE02 LIKE AFVV-VGE02,
         VGE03 LIKE AFVV-VGE03,
"  NEW FOR BASE QUNATITY AND STD VALUE
         VGW02 LIKE AFVV-VGW02,
         VGW03 LIKE AFVV-VGW03,
         BMSCH LIKE AFVV-BMSCH,"ALWAYS 1
       END OF GS.

*       DATA : GT_FINAL LIKE STANDARD TABLE OF GS ,
*       DATA : GT_FINAL TYPE TABLE  OF GS WITH NON-UNIQUE KEY VAR_L_PERC ORDERNO WCENTER WCENTER_CODE MAT DESCRIPTION  UOM ILE02 ILE03 VGE02 VGE03,
       DATA : GT_FINAL TYPE TABLE  OF GS ,
              GS_FINAL LIKE LINE OF GT_FINAL,
             GT_FINAL_F TYPE TABLE  OF GS  ,
              GS_FINAL_F LIKE LINE OF GT_FINAL_F .
*              GT_FINAL_FF TYPE TABLE  OF GS ,
*              GS_FINAL_FF LIKE LINE OF GT_FINAL_FF.

DATA:  VAR_L_PERC_SUM(16) TYPE P DECIMALS 2,
       VAR_M_PERC_SUM(16) TYPE P DECIMALS 2,
       VAR_L_SUM(16) TYPE P DECIMALS 2,
       VAR_M_SUM(16) TYPE P DECIMALS 2,
       STANDARD_L_SUM(16) TYPE P DECIMALS 2,
       STANDARD_M_SUM(16) TYPE P DECIMALS 2,
       CONF_QTY_SUM(16) TYPE P DECIMALS 2,
        INDEX TYPE I .

types : begin of ty_data,
        store(15),
        book(30),
        author(30),
        amount(7) type p,
        price type dmbtr,
        total type dmbtr, "(10) TYPE p DECIMALS 2,
        curr type waers,
        end of ty_data.

data : t_data type ty_data occurs 0 with header line.

TYPES:BEGIN OF GS_MATERIAL,
         MARA LIKE MAKT-MATNR,
         MAKTX LIKE MAKT-MAKTX,
  END OF GS_MATERIAL.
DATA: BEGIN OF WS_POP,
       CHECK TYPE CHAR1,
       MTART TYPE T134-MTART,
       END OF WS_POP.

DATA : WT_POP LIKE TABLE OF WS_POP,
       WA_POP LIKE LINE OF WT_POP.
DATA: WT_mara TYPE TABLE OF mara,
      WA_mara LIKE LINE OF WT_mara.
*DATA: WT_MAKT TYPE TABLE OF MAKT,
*      WA_MAKT LIKE LINE OF WT_MAKT.





TYPES : BEGIN OF GS_AFKO ,
    AUFNR LIKE AFKO-AUFNR,
    WERKS  LIKE CAUFV-WERKS,
    AUFPL LIKE AFKO-AUFPL,
    GSTRP LIKE AFKO-GSTRP,
    GLTRP  LIKE AFKO-GLTRP,
    PLNBEZ  LIKE AFKO-PLNBEZ,
    FEVOR  LIKE AFKO-FEVOR,
    GMEIN  LIKE AFKO-GMEIN,"BASE USNIT
    GAMNG  LIKE AFKO-GAMNG,"ORER TOTAL QUANTITY
  END OF GS_AFKO.

*TYPES : BEGIN OF GS_CAUFV ,
*    WERKS LIKE CAUFV-WERKS,
*    AUFNR LIKE CAUFV-AUFNR,
*      END OF GS_CAUFV.

TYPES : BEGIN OF GS_AFRU ,
    AUFPL LIKE AFRU-AUFPL,
    PLNBEZ LIKE AFKO-PLNBEZ,
    APLZL LIKE AFRU-APLZL,
    AUFNR LIKE AFRU-AUFNR,
    WERKS LIKE AFRU-WERKS,
    ARBID    LIKE AFRU-ARBID,
    BUDAT LIKE AFRU-BUDAT,"POSTING DATE
    ILE02 LIKE AFRU-ILE02,
    ISM02 LIKE AFRU-ISM02,
    ILE03 LIKE AFRU-ILE03,
    ISM03 LIKE AFRU-ISM03,
    GMNGA LIKE AFRU-GMNGA,
    STZHL    LIKE AFRU-STZHL,

      END OF GS_AFRU.

TYPES : BEGIN OF GS_AFVV ,
 AUFPL LIKE AFVV-AUFPL,
 APLZL LIKE AFVV-APLZL,
 BMSCH LIKE AFVV-BMSCH ,
 VGE02 LIKE AFVV-VGE02,
 VGW02 LIKE AFVV-VGW02,
 VGE03 LIKE AFVV-VGE03,
 VGW03 LIKE AFVV-VGW03,
 END OF GS_AFVV.

TYPES : BEGIN OF GS_AFVC ,
  AUFPL  LIKE AFVC-AUFPL,
   APLZL LIKE AFVC-APLZL,
   ARBID LIKE AFVC-ARBID,
  END OF  GS_AFVC.

TYPES : BEGIN OF GS_CRTX,
OBJID LIKE  CRTX-OBJID,
 KTEXT LIKE CRTX-KTEXT,
  END OF GS_CRTX.

TYPES : BEGIN OF GS_WCENTER,"first screen
 KTEXT LIKE CRTX-KTEXT,"WORK CENTER NAME
 OBJID LIKE CRTX-OBJID,"WORK CENTER OBJECT ID
 ARBPL LIKE CRHD-ARBPL, "WOEK CENTER CODE
 BUDAT LIKE AFRU-BUDAT, " posting date
  AUFNR LIKE AFRU-AUFNR,
  AUFPL LIKE AFRU-AUFPL,
  ARBID LIKE AFVC-ARBID,"OBJECT OF WORK CENTER
  PLNBEZ LIKE AFKO-PLNBEZ,
  GMNGA LIKE AFRU-GMNGA,
   MAKTX LIKE MAKT-MAKTX,
  "ACTUAL MACHINE
 ILE02 LIKE AFRU-ILE02,
 ISM02 LIKE AFRU-ISM02,
  PTIME_L LIKE AFRU-ISM03,
  PTIME_M LIKE AFRU-ISM03,
  BMSCH LIKE AFVV-BMSCH,
* ISM02(5),
  "ACTUAL LABOUR
 ILE03 LIKE AFRU-ILE03,
 ISM03 LIKE AFRU-ISM03,
* ISM03(5),

 VAR_L(5) ,"VAR LABOUR
 VAR_M(5) ,"VAR MACHINE

  "PLAN MACHINE
  VGE02 LIKE AFVV-VGE02,
  VGW02 LIKE AFVV-VGW02,
*  VGW02(5),
  "PLAN LABOUR
 VGE03 LIKE AFVV-VGE03,
  VGW03 LIKE AFVV-VGW03,
*  VGW03(5),
  END OF GS_WCENTER.


TYPES : BEGIN OF GS_WCENTER_F,"first screen
 KTEXT LIKE CRTX-KTEXT,"WORK CENTER NAME
 OBJID LIKE CRTX-OBJID,"WORK CENTER OBJECT ID
 ARBPL LIKE CRHD-ARBPL, "WOEK CENTER CODE
BUDAT LIKE AFRU-BUDAT, " posting date
 GMNGA LIKE AFRU-GMNGA,
 PTIME_L LIKE AFRU-ISM03,
  PTIME_M LIKE AFRU-ISM03,
ARBID    LIKE AFRU-ARBID,
 ISM02 LIKE AFRU-ISM02,
 ISM03 LIKE AFRU-ISM03,

 VAR_L type  AFRU-ISM02 ,"VAR LABOUR
 VAR_M TYPE AFRU-ISM02 ,"VAR MACHINE
  END OF GS_WCENTER_F.




TYPES : BEGIN OF GS_ORDERS,

* OBJID LIKE CRTX-OBJID,"WORK CENTER OBJECT ID
* ARBPL LIKE CRHD-ARBPL, "WOEK CENTER CODE
  BUDAT LIKE AFRU-BUDAT, " posting date


   AUFNR LIKE AFKO-AUFNR,
*   AUFNR TYPE i ,
 GMNGA LIKE AFRU-GMNGA,
 PTIME_L LIKE AFRU-ISM03,
  PTIME_M LIKE AFRU-ISM03,

 ISM02 LIKE AFRU-ISM02,
 ISM03 LIKE AFRU-ISM03,

 VAR_L type  AFRU-ISM02 ,"VAR LABOUR
 VAR_M TYPE AFRU-ISM02 ,"VAR MACHINE
  END OF GS_ORDERS.


  TYPES : BEGIN OF GS_CRHD,
OBJID LIKE  CRHD-OBJID,
 ARBPL LIKE CRHD-ARBPL,
 KTEXT LIKE CRTX-KTEXT,
  END OF GS_CRHD.


TYPES : BEGIN OF GS_MAKT,
  MAKTX LIKE MAKT-MAKTX,
  END OF GS_MAKT.

DATA: WT_AFKO TYPE TABLE OF GS_AFKO,
      WA_AFKO LIKE LINE OF WT_AFKO.

*DATA: WT_CAUFV TYPE TABLE OF GS_CAUFV,
*      WA_CAUFV LIKE LINE OF WT_CAUFV.

DATA: WT_AFRU TYPE TABLE OF GS_AFRU,
      WA_AFRU LIKE LINE OF WT_AFRU.

DATA: WT_AFVV TYPE TABLE OF GS_AFVV,
      WA_AFVV LIKE LINE OF WT_AFVV.

DATA: WT_AFVC TYPE TABLE OF GS_AFVC,
      WA_AFVC LIKE LINE OF WT_AFVC.

DATA: WT_CRTX TYPE TABLE OF GS_CRTX,
      WA_CRTX LIKE LINE OF WT_CRTX.

DATA: WT_CRHD TYPE TABLE OF GS_CRHD,
      WA_CRHD LIKE LINE OF WT_CRHD.

DATA: WT_MAKT TYPE TABLE OF GS_MAKT,
      WA_MAKY LIKE LINE OF WT_MAKT,

      WT_T247 TYPE TABLE OF T247,
      WA_T247 LIKE LINE OF WT_T247.

*
*DATA:  WT_WCENTER TYPE TABLE OF GS_WCENTER WITH HEADER LINE,
*       WA_WCENTER LIKE LINE OF WT_WCENTER,
*       WT_WCENTER2 TYPE TABLE OF GS_WCENTER,
*       WA_WCENTER2 LIKE LINE OF WT_WCENTER2,
*        WT_WCENTER_F TYPE TABLE OF GS_WCENTER_F,
*       WA_WCENTER_F LIKE LINE OF WT_WCENTER_F,


*       WT_Material  TYPE TABLE OF GS_MATERIAL,
*       WA_Material LIKE LINE OF WT_Material,
*
*        WT_ORDERS  TYPE TABLE OF GS_ORDERS,
*       WA_ORDERS LIKE LINE OF WT_ORDERS.
